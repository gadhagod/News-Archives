#!/usr/bin/env python

'''
newsarchives
The official CLI for the News Archives API.
By Aarav Borthakur

Docs: https://gadhagod.github.io/News-Archives
Github: https://github.com/gadhagod/News-Archives
'''

import click
import newsarchives
from json import dumps

@click.group()
def news_archives():
    'Get news of any day since October 28, 2020'

@news_archives.command(help='get articles of a day')
@click.argument('date', required=True)
@click.option('--format', required=False, is_flag=True, help='Format the JSON result')
@click.option('--timeout', required=False, type=click.INT, help='Set request timeout')
def day(date, format, timeout):
    if timeout:
        res = newsarchives.time().day(date, timeout)
    else:
        res = newsarchives.time().day(date)
    if format:
        click.echo(
            dumps(res, indent=2)
        )
    else:
        click.echo(res)

@news_archives.command(help='get articles of a month')
@click.argument('month', required=True)
@click.option('--format', required=False, is_flag=True, help='Format the JSON result')
@click.option('--timeout', required=False, type=click.INT, help='Set request timeout')
def month(month, format, timeout):
    if timeout:
        res = newsarchives.time().month(month, timeout)
    else:
        res = newsarchives.time().month(month)
    if format:
        click.echo(
            dumps(res, indent=2)
        )
    else:
        click.echo(res)

@news_archives.command(help='get articles of a year')
@click.argument('year', required=True)
@click.option('--format', required=False, is_flag=True, help='Format the JSON result')
@click.option('--timeout', required=False, type=click.INT, help='Set request timeout')
def year(year, format, timeout):
    if timeout:
        res = newsarchives.time().year(year, timeout)
    else:
        res = newsarchives.time().year(year)
    
    if format:
        click.echo(
            dumps(res, indent=2)
        )
    else:
        click.echo(res)

@news_archives.command(help='get articles with a keyword')
@click.argument('keyword', required=True)
@click.option('--format', required=False, is_flag=True, help='Format the JSON result')
@click.option('--timeout', required=False, type=click.INT, help='Set request timeout')
def keyword(keyword, format, timeout):
    if timeout:
        res = newsarchives.keyword(keyword, timeout)
    else:
        res = newsarchives.keyword(keyword)

    if format:
        click.echo(
            dumps(res, indent=2)
        )
    else:
        click.echo(res)

news_archives(prog_name='news')